{{> head}}
{{> header}}

<style>
  .management-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .management-title {
    font-size: 2.5rem;
    font-weight: 800;
    background: linear-gradient(135deg, #00d4ff 0%, #007bff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 12px;
  }

  .management-subtitle {
    color: #718096;
    font-size: 1.05rem;
  }

  .add-button-wrapper {
    text-align: center;
    margin-bottom: 30px;
  }

  .add-button {
    background: linear-gradient(135deg, #00d4ff 0%, #007bff 100%);
    color: #fff;
    border: none;
    padding: 12px 28px;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .add-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
  }

  .course-grid {
    display: grid;
    gap: 24px;
  }

  .course-item-card {
    background: #fff;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
  }

  .course-item-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .course-item-info {
    display: flex;
    align-items: center;
    gap: 20px;
    flex: 1;
  }

  .course-item-icon {
    width: 60px;
    height: 60px;
    min-width: 60px;
    min-height: 60px;
    border-radius: 16px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 1.8rem;
    font-weight: 700;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    flex-shrink: 0;
  }

  .course-item-icon::before {
    content: 'üë®‚Äçüè´';
  }

  .course-item-content h3 {
    font-size: 1.3rem;
    font-weight: 700;
    color: #1a202c;
    margin: 0;
  }

  .course-item-actions {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .btn-action {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    color: #fff;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .btn-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .btn-edit {
    background: linear-gradient(135deg, #ffd89b 0%, #ff9a00 100%);
  }

  .btn-hapus {
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
  }

  .empty-courses {
    text-align: center;
    padding: 60px 20px;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .empty-message {
    font-size: 1.2rem;
    font-weight: 600;
    color: #4a5568;
    margin-bottom: 8px;
  }

  .empty-sub {
    color: #718096;
    font-size: 0.95rem;
  }
</style>

<main class="site-root">
  <section class="my-courses-section">
    <div class="container">
      <div class="courses-panel">
        <div class="management-header">
          <h2 class="management-title">Manajemen Lecturer</h2>
          <p class="management-subtitle">Kelola data pengajar platform</p>
        </div>

        <div class="add-button-wrapper">
          <button class="add-button" onclick="openTambahLecturerModal()">
            <span>‚äï</span>
            <span>Tambah Lecturer Baru</span>
          </button>
        </div>

        {{#if lecturers.length}}
        <div class="course-grid">
          {{#each lecturers}}
          <div class="course-item-card">
            <div class="course-item-info">
              <div class="course-item-icon"></div>
              <div class="course-item-content">
                <h3>{{this.full_name}}</h3>
              </div>
            </div>
            <div class="course-item-actions">
              <button class="btn-action btn-edit" onclick="openEditLecturerModal('{{this.id}}', '{{this.full_name}}', '{{this.expertise}}', '{{this.phone}}', '{{this.email}}')">Edit</button>
              <button class="btn-action btn-hapus" onclick="deleteLecturer('{{this.id}}', '{{this.full_name}}')">Hapus</button>
            </div>
          </div>
          {{/each}}
        </div>
        {{else}}
        <div class="empty-courses">
          <p class="empty-message">Belum ada lecturer terdaftar</p>
          <p class="empty-sub">Klik "Tambah Lecturer Baru" untuk menambahkan pengajar</p>
        </div>
        {{/if}}
      </div>
    </div>
  </section>
</main>

<!-- Modal Tambah Lecturer -->
<div id="tambahLecturerModal" class="kursus-modal">
  <div class="kursus-modal-content">
    <div class="modal-logo">
      <img src="/img/logo-pngegg.png" alt="Pluvia Academy" class="modal-logo-img"/>
      <h2>Pluvia Academy</h2>
    </div>
    
    <h3 class="modal-title">Tambah Lecturer</h3>
    
    <form id="tambahLecturerForm" method="POST" action="/lecturer/create">
      <input type="text" name="full_name" placeholder="Nama Lengkap" required class="modal-input"/>
      
      <input type="text" name="expertise" placeholder="Riwayat Pendidikan" class="modal-input"/>
      
      <input type="tel" name="phone" placeholder="Nomor Hp" required class="modal-input"/>
      
      <input type="email" name="email" placeholder="Email" required class="modal-input"/>
      
      <input type="password" name="password" placeholder="Password" required class="modal-input"/>
      
      <div class="modal-actions">
        <button type="submit" class="modal-btn modal-btn-tambah">Tambah</button>
        <button type="button" class="modal-btn modal-btn-batal" onclick="closeTambahLecturerModal()">Batal</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Edit Lecturer -->
<div id="editLecturerModal" class="kursus-modal">
  <div class="kursus-modal-content">
    <div class="modal-logo">
      <img src="/img/logo-pngegg.png" alt="Pluvia Academy" class="modal-logo-img"/>
      <h2>Pluvia Academy</h2>
    </div>
    
    <h3 class="modal-title">Edit Lecturer</h3>
    
    <form id="editLecturerForm" method="POST">
      <input type="text" id="editFullName" name="full_name" placeholder="Nama Lengkap" required class="modal-input"/>
      
      <input type="text" id="editExpertise" name="expertise" placeholder="Riwayat Pendidikan" class="modal-input"/>
      
      <input type="tel" id="editPhone" name="phone" placeholder="Nomor Hp" required class="modal-input"/>
      
      <input type="email" id="editEmail" name="email" placeholder="Email" required class="modal-input"/>
      
      <input type="password" id="editPassword" name="password" placeholder="Password (kosongkan jika tidak diubah)" class="modal-input"/>
      
      <div class="modal-actions">
        <button type="submit" class="modal-btn modal-btn-edit">Edit</button>
        <button type="button" class="modal-btn modal-btn-batal" onclick="closeEditLecturerModal()">Batal</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal Konfirmasi Hapus Lecturer -->
<div id="deleteLecturerModal" class="kursus-modal">
  <div class="kursus-modal-content logout-modal-content">
    <div class="modal-logo">
      <img src="/img/logo-pngegg.png" alt="Pluvia Academy" class="modal-logo-img"/>
      <h2>Pluvia Academy</h2>
    </div>
    <h3 class="modal-title">Konfirmasi Hapus</h3>
    <p class="logout-message" id="deleteLecturerMessage">Apakah Anda yakin ingin menghapus lecturer ini?</p>
    
    <div class="modal-actions">
      <button type="button" class="modal-btn modal-btn-logout" onclick="confirmDeleteLecturer()">Ya, Hapus</button>
      <button type="button" class="modal-btn modal-btn-batal" onclick="closeDeleteLecturerModal()">Batal</button>
    </div>
  </div>
</div>

<script>
let deleteLecturerTarget = { id: null, name: null };

function openTambahLecturerModal() {
  document.getElementById('tambahLecturerModal').style.display = 'flex';
}

function closeTambahLecturerModal() {
  document.getElementById('tambahLecturerModal').style.display = 'none';
}

function openEditLecturerModal(id, fullName, expertise, phone, email) {
  const modal = document.getElementById('editLecturerModal');
  const form = document.getElementById('editLecturerForm');
  
  form.action = `/lecturer/${id}/edit`;
  document.getElementById('editFullName').value = fullName || '';
  document.getElementById('editExpertise').value = expertise || '';
  document.getElementById('editPhone').value = phone || '';
  document.getElementById('editEmail').value = email || '';
  document.getElementById('editPassword').value = '';
  
  modal.style.display = 'flex';
}

function closeEditLecturerModal() {
  document.getElementById('editLecturerModal').style.display = 'none';
}

function deleteLecturer(id, name) {
  deleteLecturerTarget = { id, name };
  document.getElementById('deleteLecturerMessage').textContent = `Apakah Anda yakin ingin menghapus lecturer "${name}"?`;
  document.getElementById('deleteLecturerModal').style.display = 'flex';
}

function closeDeleteLecturerModal() {
  document.getElementById('deleteLecturerModal').style.display = 'none';
  deleteLecturerTarget = { id: null, name: null };
}

function confirmDeleteLecturer() {
  if (!deleteLecturerTarget.id) return;
  
  fetch(`/lecturer/${deleteLecturerTarget.id}`, {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/json'
    }
  })
  .then(response => {
    if (response.ok) {
      window.location.reload();
    } else {
      console.error('Gagal menghapus lecturer');
      window.location.reload();
    }
  })
  .catch(error => {
    console.error('Error:', error);
    window.location.reload();
  })
  .finally(() => {
    closeDeleteLecturerModal();
  });
}

// Close modal when clicking outside
window.onclick = function(event) {
  const tambahModal = document.getElementById('tambahLecturerModal');
  const editModal = document.getElementById('editLecturerModal');
  const deleteModal = document.getElementById('deleteLecturerModal');
  
  if (event.target === tambahModal) {
    closeTambahLecturerModal();
  }
  if (event.target === editModal) {
    closeEditLecturerModal();
  }
  if (event.target === deleteModal) {
    closeDeleteLecturerModal();
  }
}
</script>

{{> footer}}
